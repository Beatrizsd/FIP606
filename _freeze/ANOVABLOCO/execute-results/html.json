{
  "hash": "b60deaede20b710b03441c9d5a5ae348",
  "result": {
    "markdown": "---\ntitle: \"\"\n---\n\n\n**ANOVA em bloco**\n\n### Pacotes usados\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-1_ee35837a7aad93eaf7c2cc0c3789b38a'}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(performance)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(DHARMa)\n```\n:::\n\n\n\n\n### Importar dados\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-2_cd27d747795d29a524fa0a1cf8962784'}\n\n```{.r .cell-code}\nsoja <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\n#transformar o trat e bloco em um fator\nsoja <- soja |> \n  mutate(TRAT = as.factor(TRAT),\n         BLOCO = as.factor(BLOCO))\n```\n:::\n\n\n### Visualizar\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-3_32f8265b3ea944549751003f36b758c4'}\n\n```{.r .cell-code}\ndfc <- soja %>%\n  ggplot(aes(TRAT, DFC)) +\n  geom_jitter(width = 0.1, color = \"gray60\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\ndfc\n```\n\n::: {.cell-output-display}\n![](ANOVABLOCO_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfer <- soja %>% \n  ggplot(aes(TRAT, FER )) +\n  geom_jitter(width = 0.1, color = \"gray60\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\nfer\n```\n\n::: {.cell-output-display}\n![](ANOVABLOCO_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nprod <- soja %>%\n  ggplot(aes(TRAT, PROD)) +\n  geom_jitter(width = 0.1, color = \"gray60\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\nprod\n```\n\n::: {.cell-output-display}\n![](ANOVABLOCO_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n:::\n\n\n### comparações multiplas entre tratamentos\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-4_d79516978eb51533a19953994e65e933'}\n\n```{.r .cell-code}\naov_dfc <- lm(DFC ~ TRAT + BLOCO, data = soja)\nanova(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: DFC\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 149.299 21.3284 51.5490 8.218e-12 ***\nBLOCO      3   0.461  0.1537  0.3716    0.7743    \nResiduals 21   8.689  0.4138                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#o efeito do bloco não foi significativo\n```\n:::\n\n\nChecar premissas\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-5_e825dfff26247eddf1131d9d570f3cc8'}\n\n```{.r .cell-code}\ncheck_normality(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.978).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.532).\n```\n:::\n:::\n\n\nEstimando médias\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-6_7cdf5cddef188d46c9e8e605ee658886'}\n\n```{.r .cell-code}\nmedias_dfc <- emmeans(aov_dfc, ~ TRAT)\nmedias_dfc\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean    SE df lower.CL upper.CL\n 1     10.88 0.322 21    10.21    11.54\n 2      6.42 0.322 21     5.76     7.09\n 3      6.05 0.322 21     5.38     6.72\n 4      4.75 0.322 21     4.08     5.42\n 5      4.20 0.322 21     3.53     4.87\n 6      4.00 0.322 21     3.33     4.67\n 7      4.08 0.322 21     3.41     4.74\n 8      4.58 0.322 21     3.91     5.24\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\ncld(medias_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean    SE df lower.CL upper.CL .group\n 6      4.00 0.322 21     3.33     4.67  1    \n 7      4.08 0.322 21     3.41     4.74  1    \n 5      4.20 0.322 21     3.53     4.87  1    \n 8      4.58 0.322 21     3.91     5.24  12   \n 4      4.75 0.322 21     4.08     5.42  12   \n 3      6.05 0.322 21     5.38     6.72   23  \n 2      6.42 0.322 21     5.76     7.09    3  \n 1     10.88 0.322 21    10.21    11.54     4 \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n### ANOVA para variável resposta ferrugem\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-7_1c1afaa9071945fdbed922657fd11a43'}\n\n```{.r .cell-code}\naov_fer <- lm(FER ~ TRAT + BLOCO, data = soja)\nanova(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: FER\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 978.87 139.838 55.1717 4.218e-12 ***\nBLOCO      3   3.84   1.279  0.5045    0.6834    \nResiduals 21  53.23   2.535                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nchegar premissas\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-8_d91c2ffadf6478ae2ea8bcc8ba319012'}\n\n```{.r .cell-code}\ncheck_normality(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.008).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n\n```{.r .cell-code}\n# Não atendeu as premissas\n```\n:::\n\n\n### Transformação logaritmica\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-9_60e8b65018487f91e4ef7d0251d1f33d'}\n\n```{.r .cell-code}\naov_fer <- lm(log(FER) ~ TRAT + BLOCO, data = soja)\nanova(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: log(FER)\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 11.5210 1.64585 42.9665 4.838e-11 ***\nBLOCO      3  0.2064 0.06880  1.7961    0.1788    \nResiduals 21  0.8044 0.03831                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.255).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.035).\n```\n:::\n\n```{.r .cell-code}\nmedias_fer <- emmeans(aov_fer, ~ TRAT, type = \"response\")\nmedias_fer\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT response    SE df lower.CL upper.CL\n 1       20.02 1.959 21    16.33    24.54\n 2        5.68 0.556 21     4.63     6.96\n 3        3.81 0.373 21     3.11     4.67\n 4        3.08 0.301 21     2.51     3.78\n 5        3.24 0.317 21     2.64     3.97\n 6        2.98 0.292 21     2.43     3.65\n 7        3.37 0.330 21     2.75     4.13\n 8        3.48 0.341 21     2.84     4.27\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n```\n:::\n\n```{.r .cell-code}\npwpm(medias_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1       2       3       4       5       6       7       8\n1 [20.02]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001\n2   3.525 [ 5.68]  0.1252  0.0048  0.0110  0.0028  0.0204  0.0343\n3   5.259   1.492 [ 3.81]  0.7832  0.9335  0.6440  0.9843  0.9976\n4   6.500   1.844   1.236 [ 3.08]  0.9999  1.0000  0.9976  0.9842\n5   6.178   1.753   1.175   0.951 [ 3.24]  0.9984  1.0000  0.9994\n6   6.721   1.906   1.278   1.034   1.088 [ 2.98]  0.9842  0.9431\n7   5.945   1.686   1.130   0.915   0.962   0.885 [ 3.37]  1.0000\n8   5.750   1.631   1.093   0.885   0.931   0.856   0.967 [ 3.48]\n\nRow and column labels: TRAT\nUpper triangle: P values   null = 1  adjust = \"tukey\"\nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (ratio)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\ncld(medias_fer, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT response    SE df lower.CL upper.CL .group\n 6        2.98 0.292 21     2.43     3.65  A    \n 4        3.08 0.301 21     2.51     3.78  A    \n 5        3.24 0.317 21     2.64     3.97  A    \n 7        3.37 0.330 21     2.75     4.13  A    \n 8        3.48 0.341 21     2.84     4.27  A    \n 3        3.81 0.373 21     3.11     4.67  AB   \n 2        5.68 0.556 21     4.63     6.96   B   \n 1       20.02 1.959 21    16.33    24.54    C  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 8 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\npwpm (medias_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1       2       3       4       5       6       7       8\n1 [20.02]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001\n2   3.525 [ 5.68]  0.1252  0.0048  0.0110  0.0028  0.0204  0.0343\n3   5.259   1.492 [ 3.81]  0.7832  0.9335  0.6440  0.9843  0.9976\n4   6.500   1.844   1.236 [ 3.08]  0.9999  1.0000  0.9976  0.9842\n5   6.178   1.753   1.175   0.951 [ 3.24]  0.9984  1.0000  0.9994\n6   6.721   1.906   1.278   1.034   1.088 [ 2.98]  0.9842  0.9431\n7   5.945   1.686   1.130   0.915   0.962   0.885 [ 3.37]  1.0000\n8   5.750   1.631   1.093   0.885   0.931   0.856   0.967 [ 3.48]\n\nRow and column labels: TRAT\nUpper triangle: P values   null = 1  adjust = \"tukey\"\nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (ratio)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\n# a transformação logaritmica não foi adequada para atender as premissas\n```\n:::\n\n\n### Transformação box-cox\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-10_569f5b136a079d159bb2e47dea07f01d'}\n\n```{.r .cell-code}\nb <- boxcox(lm(soja$FER ~1))\n```\n\n::: {.cell-output-display}\n![](ANOVABLOCO_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlambda<- b$x[which.max(b$y)]\nlambda\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1.555556\n```\n:::\n\n```{.r .cell-code}\nsoja$FER2 <- (soja$FER ^ lambda - 1) / lambda\n```\n:::\n\n\n### ANOVA para variável resposta produtividade\n\n\n::: {.cell hash='ANOVABLOCO_cache/html/unnamed-chunk-11_3b87ede7d03b04d9cab6e190120a199c'}\n\n```{.r .cell-code}\n#construindo função para anova\naov_prod <- lm(log(PROD) ~ TRAT + BLOCO, data = soja)\nanova(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: log(PROD)\n          Df   Sum Sq   Mean Sq F value  Pr(>F)  \nTRAT       7 0.143280 0.0204686  2.8143 0.03113 *\nBLOCO      3 0.005813 0.0019378  0.2664 0.84881  \nResiduals 21 0.152733 0.0072730                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# Verificar os pressupostos\ncheck_normality(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.325).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.013).\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(aov_prod))\n```\n\n::: {.cell-output-display}\n![](ANOVABLOCO_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Comparação de médias\nmedias_prod <- emmeans(aov_prod, ~ TRAT, type = \"response\")\nmedias_prod\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT response  SE df lower.CL upper.CL\n 1        4189 179 21     3834     4578\n 2        4935 210 21     4516     5392\n 3        5108 218 21     4675     5582\n 4        5129 219 21     4693     5604\n 5        5113 218 21     4679     5587\n 6        5246 224 21     4801     5732\n 7        5108 218 21     4675     5582\n 8        5067 216 21     4637     5537\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n```\n:::\n\n```{.r .cell-code}\npwpm(medias_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       1      2      3      4      5      6      7      8\n1 [4189] 0.1725 0.0574 0.0500 0.0554 0.0225 0.0574 0.0750\n2  0.849 [4935] 0.9989 0.9977 0.9987 0.9668 0.9989 0.9998\n3  0.820  0.966 [5108] 1.0000 1.0000 0.9998 1.0000 1.0000\n4  0.817  0.962  0.996 [5129] 1.0000 0.9999 1.0000 1.0000\n5  0.819  0.965  0.999  1.003 [5113] 0.9998 1.0000 1.0000\n6  0.799  0.941  0.974  0.978  0.975 [5246] 0.9998 0.9989\n7  0.820  0.966  1.000  1.004  1.001  1.027 [5108] 1.0000\n8  0.827  0.974  1.008  1.012  1.009  1.035  1.008 [5067]\n\nRow and column labels: TRAT\nUpper triangle: P values   null = 1  adjust = \"tukey\"\nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (ratio)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\nmedias_prod_group <- cld(medias_prod, letters = LETTERS)\ncld(medias_prod, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT response  SE df lower.CL upper.CL .group\n 1        4189 179 21     3834     4578  A    \n 2        4935 210 21     4516     5392  AB   \n 8        5067 216 21     4637     5537  AB   \n 3        5108 218 21     4675     5582  AB   \n 7        5108 218 21     4675     5582  AB   \n 5        5113 218 21     4679     5587  AB   \n 4        5129 219 21     4693     5604   B   \n 6        5246 224 21     4801     5732   B   \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 8 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}