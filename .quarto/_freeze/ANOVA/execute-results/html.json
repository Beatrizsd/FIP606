{
  "hash": "f982cfad8492a398ae04ad409c92d964",
  "result": {
    "markdown": "---\ntitle: \"\"\n---\n\n\n# Análise de variância (ANOVA)\n\nA ANOVA é um método estatístico usado para testar as diferenças entre dois ou mais grupos, usando o teste F.\n\n### Pacotes Usados\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-1_da6bdede29f419536abbed60b5193ed6'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(performance)\nlibrary(DHARMa)\nlibrary(emmeans)\n```\n:::\n\n\n\n*Importação dos dados*\n\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-2_bfacce5edd2b083c1c2fa530ff552eb8'}\n\n```{.r .cell-code}\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n```\n:::\n\n\n*Visualização dos dados*\n\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-3_ada6c0bdd40f40d8fc6b5401dd3c3264'}\n\n```{.r .cell-code}\nmicelial |> \n  ggplot(aes(especie, tcm))+\n  geom_boxplot()+\n  geom_jitter(width = 0.05)\n```\n\n::: {.cell-output-display}\n![](ANOVA_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## ANOVA usando modelo lm\n\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-4_63ed9502f0c5a319010ef2252023a669'}\n\n```{.r .cell-code}\nm1 <- lm(tcm ~ especie, data = micelial)\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# rejeita a hipotese nula de que as médias são iguais, pelo menos um grupo difere dos demais grupos.\n```\n:::\n\n\n### Verificar se as premissas são atendidas\n\nPara verificar as premissas do teste, vamos usar o pacote performance e o pacote DHARMa\n\n### Normalidade dos resíduos\n\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-5_840018fd0d99d1f0a350672c7bd31ad6'}\n\n```{.r .cell-code}\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n:::\n\n```{.r .cell-code}\n#normalidade ok\n```\n:::\n\n\nNormalidade visual\n\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-6_26b8ef1014219712b397a75ff4daef90'}\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](ANOVA_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(m1$residuals)\nqqline(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](ANOVA_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\n### homogeneidade das variâncias\n\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-7_119b888d44f2b5132d72482e90ee308d'}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n:::\n:::\n\n\nUsando o pacote DHARMa da para checar a normalidade e homocedasticidade de maneira mais pratica\n\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-8_d353ae281512aebe04ad2b67dfe60c77'}\n\n```{.r .cell-code}\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](ANOVA_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### comparação de médias\n\nPara comparar as médias dos grupos usaremos o pacote emmeans e multcomp\n\n\n::: {.cell hash='ANOVA_cache/html/unnamed-chunk-9_8e75e770cf17f292b920476d1f826300'}\n\n```{.r .cell-code}\nmeans_m1 <- emmeans(m1, ~ especie)\nmeans_m1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\nmeans_m1df <- data.frame(means_m1)\n\nmeans_m1df |> \n  ggplot(aes(especie, emmean))+\n  geom_point()+\n  geom_errorbar(aes(min = lower.CL,\n                    max = upper.CL),\n                width = 0.1)\n```\n\n::: {.cell-output-display}\n![](ANOVA_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\npwpm(means_m1) #tukey\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Fasi    Faus    Fcor    Fgra    Fmer\nFasi [1.572]  0.0023  0.0302  <.0001  0.3765\nFaus   0.335 [1.237]  0.8169  0.0031  0.1469\nFcor   0.250  -0.085 [1.322]  0.0002  0.6761\nFgra   0.660   0.325   0.410 [0.912]  <.0001\nFmer   0.145  -0.190  -0.105  -0.515 [1.427]\n\nRow and column labels: especie\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\ncld(means_m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}